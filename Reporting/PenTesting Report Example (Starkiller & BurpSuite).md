

## Executive Summary

- **Overview**: Lipscomb University Cyber Defense has provided a comprehensive penetration testing engagement, which was conducted on the client's web application and internal network infrastructure.

- **Critical Findings**: Several critical vulnerabilities were identified, including a remote code execution vulnerability in several web applications and weak Active Directory domain controller configurations. We recommend taking immediate action to remediate.

## Introduction

- **Scope and Objectives**: The scope of the penetration testing engagement included both the client's public-facing web application (https://wesbite_here) and the internal network infrastructure. The objectives were to identify possible security vulnerabilities, assess the potential impact of said vulnerabilities, and provide remediation recommendations.

- **Methodology and Standards**: The testing methodology followed the OWASP Testing Guide v4, NIST SP 800-115, and the MITRE attack framework. The engagement adhered to the Penetration Testing Execution Standard (PTES).

- **Timeline**: The penetration testing engagement was conducted from April 28th, 2024, between the hours of 12:00pm - 5:00pm

- **Team Members**: The testing team consisted of Jeffrey Allen (Lead Penetration Tester)

## Assessment Methodology

- **Testing Phases**: The assessment was conducted in five phases: reconnaissance, enumeration, exploitation, post-exploitation, and reporting.

- **Tools and Techniques**: Various tools and techniques were employed, including Nmap for network scanning, Burp Suite for web application testing, and PowerShell Empire's Starkiller for post-exploitation.

- **Limitations and Constraints**: The testing was performed in a non-production environment without affecting any live in-production systems. Social engineering and physical security testing of any kind were out of scope for this test.

## Findings

- **Vulnerability Details**:
  - *Severity Level*: Critical
  - *Affected Systems or Applications*: Clients web application (https://website_here)

  - *Technical Details and PoC Screenshots*: A remote code execution vulnerability was identified in the file upload functionality. An attacker could upload a malicious PHP file and gain unauthorized access to the server. 
  
	  - [Insert screenshot here]

  - *Potential Impact and Risk*: An attacker could execute arbitrary commands, steal sensitive data, and potentially compromise the entire web server.

  - *Recommendations for Remediation*: Implement proper file type validation and sanitization on the server-side. Restrict file upload permissions and enforce strict access controls.

- **Prioritized Vulnerabilities**: 
	  1. Remote Code Execution in Web Application (Critical)
	  2. Weak Active Directory Domain Controller Configurations (High)
	  3. Unpatched SQL Injection Vulnerability in Login Page (Medium)

## Exploitation Scenarios

- **Successful Exploitation Attempts**: Using PowerShell Empire's Starkiller, we had successfully exploited the remote code execution vulnerability in the web application. A malicious PHP file was uploaded, and a reverse shell was obtained.

- **Exploitation Walkthrough**: 
	  1. Uploaded a malicious PHP file using the vulnerable file upload functionality.
	  2. Accessed the uploaded file via the web browser, triggering the reverse shell connection.
	  3. Obtained a Starkiller agent on the compromised web server.

- **Impact Demonstration**: With the obtained reverse shell, we were able to execute arbitrary commands, access sensitive files, and potentially pivot to other systems in the network.

## Post-Exploitation

- **Post-Exploitation Activities**: Using the Starkiller agent, we performed post-exploitation activities on the compromised web server.

- **Sensitive Data Accessed**: We accessed the database credentials stored in the web application's configuration files.

- **Persistence Mechanisms**: A backdoor was established using a webshell for persistent access to the compromised server.

- **Lateral Movement and Privilege Escalation**: Attempts to move laterally to other systems in the network were not successful due to segmentation controls and access controls that were in place.

## Remediation Recommendations

- **Prioritized Recommendations**: 
	  1. Implement server-side validation and sanitization for file uploads.
	  2. Update and patch the identified SQL injection vulnerability in the login page.
	  3. Strengthen Active Directory domain controller configurations, including enforcing strong password policies and enabling multi-factor authentication.
  
- **Best Practices and Security Controls**: Implement least privilege access, regularly update and patch systems, and conduct security awareness training for employees.

- **Patch Management and Configuration Hardening**: Establish a regular patch management process and harden system configurations (remove unneccessary applications, services, roles and features) in accordance with industry best practices and benchmarks.

## Conclusion

- **Overall Security Posture**: The client's security posture has significant weaknesses, particularly in the web application and Active Directory configurations. However, the network segmentation and access controls demonstrated good security practices.

- **Key Takeaways**: Regular vulnerability assessments, patching, and configuration hardening are essential to maintain a strong security posture. Employee security awareness training is imperative to prevent social engineering attacks.

- **Next Steps**: Prioritize the remediation of identified vulnerabilities, starting with the critical and high-severity ones. Conduct a follow-up assessment to validate the effectiveness of the implemented security controls.

## Appendices

- **Tools Used**: 
  - Nmap
  - Burp Suite
  - PowerShell Empire's Starkiller

- **References**: 
  - OWASP Testing Guide v4
	  - [https://owasp.org/www-project-web-security-testing-guide/v41/](https://owasp.org/www-project-web-security-testing-guide/v41/)
  - NIST SP 800-115
	  - [https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-115.pdf](https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-115.pdf)
  - MITRE Attack Framework
	  - https://attack.mitre.org
  - Penetration Testing Execution Standard (PTES)
	  - [http://www.pentest-standard.org/](http://www.pentest-standard.org/)

## Disclaimer

- **Permission Statement**: The penetration testing engagement was conducted with the explicit written permission of the client.

- **Scope Limitations**: The testing scope was limited to the agreed-upon systems and did not include all possible attack vectors or vulnerabilities.

- **Confidentiality and NDA**: All information related to the client and the penetration testing engagement is kept strictly confidential and protected under the terms of the non-disclosure agreement (NDA).